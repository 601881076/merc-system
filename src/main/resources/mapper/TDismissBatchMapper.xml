<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhnj.mapper.TDismissBatchMapper">
    <sql id="dismissSql">
        id,
        system_type,
        source_type,
        bank_code,
        system_batch,
        batch_desc,
        total_trans,
        success_trans,
        fail_trans,
        status,
        create_time,
        update_time
    </sql>
    <select id="listPage" resultType="com.xhnj.model.TDismissBatch">
        select <include refid="dismissSql"/> from t_dismiss_batch where 1=1
        <if test="dismissBatch.createTime!=null">
            and create_time<![CDATA[ >= ]]>#{dismissBatch.createTime,jdbcType=TIMESTAMP}
        </if>
        <if test="dismissBatch.systemBatch!=null and dismissBatch.systemBatch!=''">
            and system_batch=#{dismissBatch.systemBatch,jdbcType=VARCHAR}
        </if>
        <if test="dismissBatch.status!=null and dismissBatch.status!=''">
            and status=#{dismissBatch.status,jdbcType=INTEGER}
        </if>
    </select>
    <delete id="deleteById">
        delete from t_dismiss_batch where status=-1 and id=#{id}
    </delete>

    <!--审核员授权取消审批-拒绝操作-->
    <update id="updateStatusByBatchNo" parameterType="list">
        update t_batch_check set
        status = #{status}, check_result = #{checkResult}
        where batch_id in
        (
        <foreach collection="batchNo" item="item" index="index" separator=",">
        #{item}
        </foreach>
        )
    </update>
</mapper>